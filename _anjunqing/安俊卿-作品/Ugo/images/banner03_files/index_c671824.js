;/*!/widget/index/nav/nav.js*/
define("yc_piao:widget/index/nav/nav",function(require,exports,module){var PIAO_NAV_TMPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push("");var letterArray=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W"];if(_template_fun_array.push('    <div class="piao-widget-index-nav clearfix">        <ul class="clearfix">            '),list&&0!=list.length){_template_fun_array.push("                    ");for(var i=0;i<list.length;i++){var item=list[i];_template_fun_array.push('                    <li class="touching" data-url="piaolisttpl" bn-data={"typeId":"',"undefined"==typeof item.typeId?"":baidu.template._encodeHTML(item.typeId),'","typeIdName":"',"undefined"==typeof item.title?"":baidu.template._encodeHTML(item.title),'"} bn-target=1>                        <img src="',"undefined"==typeof item.img?"":baidu.template._encodeHTML(item.img),'"><p>'),9==item.typeId?_template_fun_array.push("更多"):_template_fun_array.push("","undefined"==typeof item.title?"":baidu.template._encodeHTML(item.title),""),_template_fun_array.push("</p>                    </li>                    ")}_template_fun_array.push("        </ul>    </div>"),_template_varName=null}}(_template_object);return fn=null,_template_fun_array.join("")}][0],nav={init:function(e){this.$el=$("#piao-widget-index-nav"),this.$el.html(PIAO_NAV_TMPL({list:e}))}};module.exports=nav});
;/*!/widget/index/chunks/chunks.js*/
define("yc_piao:widget/index/chunks/chunks",function(require,exports,module){var PIAO_CHUNKS_TMPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="piao-widget-index-chunks border border-bottom border-top">    ');for(var i=0;i<list.length;i++){var item=list[i];_template_fun_array.push("    <div "),_template_fun_array.push(0==i?'class="touching" data-log="{&#39;da_src&#39;:&#39;bnpiaoIndexPg.chunksBk.onrankLnk&#39;}" data-url="piaolisttpl" bn-data={"rank":"onTime","rankName":"按上架时间"} bn-target=1':'class="touching border border-left" data-log="{&#39;da_src&#39;:&#39;bnpiaoIndexPg.chunksBk.calendarLnk&#39;}" data-url="calendartpl"'),_template_fun_array.push(">        <div>            <h1>","undefined"==typeof item.title?"":baidu.template._encodeHTML(item.title),"</h1>            <h3>","undefined"==typeof item.desc?"":baidu.template._encodeHTML(item.desc),'</h3>        </div>        <div class="icon">            <a><img src="',"undefined"==typeof item.img?"":baidu.template._encodeHTML(item.img),'"></a>        </div>    </div>    ')}_template_fun_array.push("</div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],chunks={init:function(e){this.$el=$("#piao-widget-index-chunks"),this.$el.html(PIAO_CHUNKS_TMPL({list:e}))}};module.exports=chunks});
;/*!/widget/index/activity/activity.js*/
define("yc_piao:widget/index/activity/activity",function(require,exports,module){var PIAO_ACT_TMPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push("");var parcent=data.saleRation;_template_fun_array.push('    <div class="act-warpper touching border border-bottom">        <div class="banner-content" data-log="{&#39;da_src&#39;:&#39;bnpiaoIndexPg.actBk.actLnk&#39;}" data-url="piaodetailtpl" bn-data={"productId":',"undefined"==typeof data.productId?"":baidu.template._encodeHTML(data.productId),'} bn-target=1>            <section class="fl banner-thumb" data-type="show_img">                <img src="',"undefined"==typeof data.pictureSmall?"":baidu.template._encodeHTML(data.pictureSmall),'" title="" alt=""/>            </section>            <section class="fl banner-text">                <h1>'),data.text&&_template_fun_array.push("<m>","undefined"==typeof data.text?"":baidu.template._encodeHTML(data.text),"</m>"),_template_fun_array.push(" ","undefined"==typeof data.productName?"":baidu.template._encodeHTML(data.productName),"</h1>                <h3>","undefined"==typeof data.recommend?"":baidu.template._encodeHTML(data.recommend),'</h3>                <div class="piao-info" '),0==data.isStart&&_template_fun_array.push('style="top:76px;"'),_template_fun_array.push('>                    <p><span class="price">￥</span>',"undefined"==typeof(data.lowestPrice||0)?"":baidu.template._encodeHTML(data.lowestPrice||0),'<span class="lowest"> 起</span>'),data.discount&&10!=data.discount&&_template_fun_array.push('<span class="discount">',"undefined"==typeof data.discount?"":baidu.template._encodeHTML(data.discount),"折</span>"),_template_fun_array.push("</p>                    "),1==data.isStart?(_template_fun_array.push("                        "),parcent&&"-1"!=parcent?_template_fun_array.push('                            <div><div style="width: ',"undefined"==typeof parcent?"":baidu.template._encodeHTML(parcent),'"></div><p>',"undefined"==typeof data.info?"":baidu.template._encodeHTML(data.info),"</p></div>                        "):_template_fun_array.push('                            <p class="info">',"undefined"==typeof data.info?"":baidu.template._encodeHTML(data.info),"</p>                        "),_template_fun_array.push('                        <p class="btn '),1==data.buttonType?_template_fun_array.push('disable">',"undefined"==typeof data.buttonText?"":baidu.template._encodeHTML(data.buttonText),""):_template_fun_array.push('">去抢票'),_template_fun_array.push("</p>                    ")):_template_fun_array.push('                        <strong class="hours">',"undefined"==typeof data.hours?"":baidu.template._encodeHTML(data.hours),'</strong>:<strong class="minutes">',"undefined"==typeof data.minutes?"":baidu.template._encodeHTML(data.minutes),'</strong>:<strong class="seconds">',"undefined"==typeof data.seconds?"":baidu.template._encodeHTML(data.seconds),'</strong>                        <p class="info float-right">',"undefined"==typeof data.info?"":baidu.template._encodeHTML(data.info),"</p>                    "),_template_fun_array.push("                </div>            </section>        </div>    </div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],ARGS="/yanchu/info/activity";module.exports={init:function(e){var t=this;t.$el=$("#piao-widget-index-activity"),t.searchAjax(e.cityId)},searchAjax:function(e){var t,a=this,n={},i={};n={adSpaceId:"43",cityId:e},PJS.http.piaoajax({url:ARGS,data:n,type:"get",dataType:"json",success:function(e){e.errorNo||0==e.data.activityList.length||(i=e.data.activityList[0],t=1e3*e.timestamp,i.startTime=i.startTime.split("-").join("/"),i.endTime=i.endTime.split("-").join("/"),0==i.isStart&&(a.setTimeCount(i,t),a.timeRefresh(t,i.startTime,i)),0==i.stock&&(i.buttonType=1,i.buttonText="已抢光",i.info=i.info||"已售100% | 无剩余"),parseInt(new Date(i.endTime).getTime())<parseInt(t)&&(i.buttonType=1,i.buttonText="已结束"),a.$el.html(PIAO_ACT_TMPL({data:i})),0==i.isStart&&a.refreshCount(i,t),new Date(i.startTime).getTime()<t&&(clearInterval(a.setTimeRefresh),clearInterval(a.settimeCount)))},error:function(){}})},setTimeCount:function(e,t){var a,n;return a=new Date(e.startTime).getTime(),timeCount=a-t,0>timeCount?(e.isStart=1,!1):(n=Math.floor(timeCount/864e5),leave1=timeCount%864e5,e.hours=Math.floor(leave1/36e5)+24*n,e.hours=e.hours>=10?e.hours:"0"+e.hours,leave2=leave1%36e5,e.minutes=Math.floor(leave2/6e4),e.minutes=e.minutes>=10?e.minutes:"0"+e.minutes,leave3=leave2%6e4,e.seconds=Math.round(leave3/1e3),void(e.seconds=e.seconds>=10?e.seconds:"0"+e.seconds))},timeRefresh:function(e,t,a){var n,i=this;return n=new Date(t).getTime(),timeCount=n-e,0>timeCount?(a.isStart=1,!1):(timeCount=parseInt(timeCount/3e4),i.setTimeRefresh&&clearInterval(i.setTimeRefresh),void(i.setTimeRefresh=setInterval(function(){i.searchAjax()},3e4)))},refreshCount:function(e,t){var a=this;a.settimeCount&&clearInterval(a.settimeCount),a.settimeCount=setInterval(function(){t+=1e3,a.setTimeCount(e,t),a.$el.find(".hours").html(e.hours),a.$el.find(".minutes").html(e.minutes),a.$el.find(".seconds").html(e.seconds),"00"==e.hours&&"00"==e.minutes&&"00"==e.seconds&&(a.searchAjax(),clearInterval(a.settimeCount))},1e3)}}});
;/*!/widget/index/recommend/recommend.js*/
define("yc_piao:widget/index/recommend/recommend",function(require,exports,module){var TPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="recomand-show border border-bottom border-top">    <span class="dividing-line border border-left"></span>    <div class="adapter-text">        <ul id="slides-record">            ');for(var i=0;i<data.length;i++){var item=data[i];_template_fun_array.push("            <li "),_template_fun_array.push(item.productId?' data-log="{&#39;da_src&#39;:&#39;bnpiaoIndexPg.recommendBk.recommendLnk&#39;}" data-url="piaodetailtpl" ':'data-url="calendartpl"'),_template_fun_array.push('bn-data={"productId":"',"undefined"==typeof item.productId?"":baidu.template._encodeHTML(item.productId),'"} bn-target=1>',"undefined"==typeof item.productName?"":baidu.template._encodeHTML(item.productName),"</li>            ")}_template_fun_array.push("        </ul>    </div></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],pjsDate=require("yc_common:static/util/date.js"),ARGS="/yanchu/info/piaosearch",recommend={init:function(e){self=this,self.$el=$(e.container),self.cityId=e.cityId,self.searchAjax()},searchAjax:function(){var e=this,a={},t=[];a={cityId:1,page:1,pageSize:10,from:"pc"},PJS.http.piaoajax({url:ARGS,data:a,type:"get",respType:"json",success:function(a){a.data=a.data||{},!a.errorNo&&a.data&&a.data.productList&&(t=a.data.productList.slice(0,5),e.$el.html(TPL({data:t})),e.recordScroll(32,20,5e3))},error:function(){PJS.ui.showErrorPage(1)}})},recordScroll:function(e,a,t){function r(){o=setInterval(n,a);var e=parseInt($(d).css("marginTop"))-1+"px";$(d).css("marginTop",e)}function n(){if(parseInt($(d).css("marginTop"))%e!=0){var a=parseInt($(d).css("marginTop"))-1+"px";$(d).css("marginTop",a),Math.abs(parseInt($(d).css("marginTop")))>=$(d)[0].scrollHeight/2&&$(d).css("marginTop",0)}else clearInterval(o),setTimeout(r,t)}var o,i=this,d=i.$el.find("#slides-record");$(d).append($(d).html()),$(d).css("marginTop",0),setTimeout(r,t)}};module.exports=recommend});
;/*!/widget/index/data.js*/
define("yc_piao:widget/index/data",function(i,t,e){data={category:[{title:"演唱会",img:"http://d.hiphotos.baidu.com/movie/pic/item/ac345982b2b7d0a23f20079accef76094a369acf.jpg",typeId:"1"},{title:"话剧舞台剧",img:"http://g.hiphotos.baidu.com/movie/pic/item/6159252dd42a283422f4350c5cb5c9ea15cebf62.jpg",typeId:"3"},{title:"体育赛事",img:"http://e.hiphotos.baidu.com/movie/pic/item/6a63f6246b600c338bd7ddcf1d4c510fd9f9a10e.jpg",typeId:"6"},{title:"音乐会",img:"http://h.hiphotos.baidu.com/movie/pic/item/d6ca7bcb0a46f21fb96f5d54f1246b600c33ae59.jpg",href:"piaolist",typeId:"2"},{title:"儿童亲子",img:"http://g.hiphotos.baidu.com/movie/pic/item/962bd40735fae6cddda0a86608b30f2442a70fa4.jpg",typeId:"9"}],userBlock:[{title:"最新票品",img:"http://d.hiphotos.baidu.com/movie/pic/item/ac345982b2b7d0a23f20079accef76094a369acf.jpg",desc:"新上票品抢鲜看"},{title:"演出日历",img:"http://d.hiphotos.baidu.com/movie/pic/item/ac345982b2b7d0a23f20079accef76094a369acf.jpg",desc:"纪念日有我陪伴"}]},e.exports=data});
;/*!/widget/index/index.js*/
define("yc_piao:widget/index/index",function(i,t,a){var n=i("yc_common:widget/web/banner/banner.js"),e=i("yc_piao:widget/index/nav/nav"),c=i("yc_piao:widget/index/chunks/chunks"),o=i("yc_piao:widget/index/activity/activity"),d=i("yc_common:widget/web/filter/filter.js"),r=i("yc_common:widget/web/list/list.js"),p=i("yc_piao:widget/index/recommend/recommend"),l="/yanchu/info/catblock";i("yc_piao:widget/index/data"),a.exports={init:function(){var i=this;PJS.location.getLocation({success:function(t){i._loc=t||{},i.cityId=t.nuomiCityCode,i.cityName=t.cityName,i.initList(),i.barBtn()},fail:function(){}})},initList:function(){var i=this,t={};t={cityId:i.cityId},i.initcatblock(),t.container="#piao-widget-index-recommend",p.init(t),o.init(t),n.init(),d.init({initPageSize:10,pageSize:10,domObj:"#piao-common-filter",pageindex:"index",params:{pageFlag:1},locParam:{cityId:i.cityId,cityName:i.cityName},headerClass:"index-filter",callback:i.callback}),r.init({pagescroll:!0,showRankNum:!0,daSrc:"bnpiaoIndexPg.listBk.piaoLnk",update:i.getUpdateData,top:258,userCityId:i.cityId,ifEmptyHideBar:!0,emptyMsg:"<p>本地暂无演出，</p><p>换个城市试试吧！</p>"}),PJS.ui.hideLoadingPage()},initcatblock:function(){var i={};PJS.http.piaoajax({url:l,type:"get",dataType:"json",success:function(t){!t.errorNo&&t.data&&(i=t.data),i=i.category?i:data,e.init(i.category),c.init(i.userBlock)},error:function(){e.init(data.category),c.init(data.userBlock)}})},callback:function(i){r.create(i)},getUpdateData:function(i){d.update(i)},barBtn:function(){PJS.page.onBtnBackClick({callback:function(){PJS.stat.addStat({da_src:"bnpiaoIndexPg.callbackBtn",da_act:"click"}),PJS.page.back()}}),PJS.ui.share()}}});