!function(root,factory){"function"==typeof define?define("Raffle",[],function(){return factory(root)}):root.Raffle=factory(root)}(this,function(){var $affle_div,$prize,$color,$prizeIndex,$rotationmix,$rotationmax,$dis,$isMobile=navigator.userAgent.match(/(iPhone|iPod|Android|iPad|BlackBerry|webOS)/i)?!0:!1,$config={},$wmode="opaque";$running=!1;var Raffles=function(){};Raffles.prototype={extend:function(o,obj){var merge=function(o,n){n=n||{};for(var i in o)o.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(n[i]=o[i]);return n},temp=merge(o.prototype,obj),F=function(){};for(var i in temp)F.prototype[i]=temp[i];var N=function(){o.apply(this,arguments)};return N.prototype=new F,N},getImage:function(url){var $self=this,$img=new Image;return $img.style.position="absolute",url&&0!=url.length&&($img.src=url,$img.onload=function(e){$self.resizeUI($affle_div,e.target)}),$img},resizeUI:function(d,img){var $per=(img.width||img.offsetWidth)/(img.height||img.offsetHeight),$w=d.offsetWidth,$h=d.offsetHeight;((img.width||img.offsetWidth)>$w||(img.height||img.offsetHeight)>$h)&&($w/$h>$per?(img.height=$h,img.width=img.height*$per>>0):(img.width=$w,img.height=img.width/$per>>0)),img.style.left=($w-(img.width||img.offsetWidth)>>1)+d.offsetLeft+"px",img.style.top=($h-(img.height||img.offsetHeight)>>1)+d.offsetTop+"px"},bool:function(value){return"number"==typeof value?!(0==value):"string"==typeof value?!(""==value||"false"==value||"0"==value):"object"==typeof value?!(null==value):"boolean"==typeof value?value:!0},easeInOut:function(t,b,c,d){var a=4*c/(d*d);return 1>2*t/d?(a*t*t/2).toFixed(2):(a*t*t/2-a*(t-d/2)*(t-d/2)).toFixed(2)}};var Raffle=new Raffles,RA=function(config,response,result){if(!config.box||!document.getElementById(config.box))return void alert("请确认转盘所需的相关承载容器");if(!config.prize)return void alert("请确保传递 prize 等必选参数");for(var i in config)$config[i]=config[i];getResponse=response,getResult=result;config.wmode&&($wmode=config.wmode),config.color&&($color=decodeURIComponent(config.color).split("|")),$prize=config.prize,$prizeIndex=parseInt(config.prizeindex),$affle_div=document.getElementById(config.box),$rotationmix=config.rotationmix,$rotationmax=config.rotationmax,$dis=config.dis;var $tt_ow=$affle_div.offsetWidth,$tt_oh=$affle_div.offsetHeight;$isMobile&&(this.images=[],this.isAllloaded=!1,this.cv=document.createElement("canvas"),this.wh=Math.min($tt_ow-config.padding,$tt_oh-config.padding),this.cv.width=this.wh,this.cv.height=this.wh,this.cv.style.position="absolute",this.cv.style.left=($tt_ow-this.wh>>1)+$affle_div.offsetLeft+"px",this.cv.style.top=($tt_oh-this.wh>>1)+$affle_div.offsetTop+"px",$affle_div.appendChild(this.cv))};return RA.prototype={loadImage:function(){function load(){function loop(){$count<$prize.length-1?($count++,load()):$self.isAllloaded=!0}var $img=new Image;return $img.style.position="absolute",$img.src=$prize[$count].img,$self.images[$count]=$img,$img.complete?void loop():($img.onerror=function(){loop()},void($img.onload=function(){loop()}))}var $self=this,$count=0;load()}},Raffle.RA=RA,Raffle.Slotmachine=Raffle.extend(Raffle.RA,{execute:function(obj){function rotate(b,c,fn,cb){var d=4e3,t=0,dis=20,inter=setInterval(function(){t+=dis,fn(Raffle.easeInOut(t,b,c,d)),t==d&&(clearInterval(inter),cb&&"function"==typeof cb&&cb())},dis)}if(!$running){this.startIndex=0,$running=!0,$prizeIndex=parseInt(obj.prizeindex);var $self=this;rotate($self.startIndex,$self.getRotationLong($self.totalNum,$rotationmix,$rotationmax,$prizeIndex),function(x){$self.startIndex=(x>>0)%$self.totalNum,$self.draw()},function(){getResult({index:$prizeIndex}),$prizeIndex=NaN,$running=!1,$self.startIndex=NaN})}},startUp:function(){this.dis=$dis,this.sideNum=4,this.singleNum=Math.ceil($prize.length/this.sideNum),this.totalNum=this.singleNum*this.sideNum,this.loadImage();var $self=this,$inter=setInterval(function(){$self.isAllloaded&&(clearInterval($inter),$self.draw())},10);this.pointer=document.getElementById($config.pointer),this.pointer.style.position="absolute",this.pointer.style.display="block",Raffle.resizeUI(this.cv,this.pointer),this.pointer.style.cursor="pointer",this.pointer.onclick=function(){return $self.isAllloaded?isNaN($prizeIndex)?void getResponse():void $self.execute({prizeindex:$prizeIndex}):void 0}},draw:function(){var $wh=(this.wh-this.singleNum*this.dis)/(this.singleNum+1)>>0;for(var p in this.images){var img=this.images[p],$per=img.width/img.height,$w=$wh,$h=$wh;(img.width>$w||img.height>$h)&&($w/$h>$per?(img.height=$h,img.width=img.height*$per>>0):(img.width=$w,img.height=img.width/$per>>0))}if(this.cv.getContext){var $ctx=this.cv.getContext("2d");$ctx.clearRect(0,0,this.cv.width,this.cv.height);for(var i=0;i<this.totalNum;i++){var $x,$y;i<this.singleNum?($x=i*($wh+this.dis),$y=0):i>=this.singleNum&&i<2*this.singleNum?($x=this.singleNum*($wh+this.dis),$y=(i-this.singleNum)*($wh+this.dis)):i>=2*this.singleNum&&i<3*this.singleNum?($x=Math.abs(i-3*this.singleNum)*($wh+this.dis),$y=this.singleNum*($wh+this.dis)):i>=3*this.singleNum&&($x=0,$y=Math.abs(i-4*this.singleNum)*($wh+this.dis)),i==this.startIndex&&($color&&1==$color[0]?($ctx.fillStyle=$color&&$color[1]?$color[1]:"#00ccff",$ctx.fillRect($x,$y,$wh,$wh)):this.drawSector($ctx,$x,$y,$wh,$color&&$color[1]?$color[1]:"#00ccff")),$ctx.save(),$x+=$wh-this.images[i].width>>1,$y+=$wh-this.images[i].height>>1,$ctx.drawImage(this.images[i],$x,$y,this.images[i].width,this.images[i].height),$ctx.restore()}}},drawSector:function(ctx,x,y,radius,color){ctx.beginPath(),ctx.lineWidth=3,ctx.strokeStyle=color,ctx.moveTo(x,y),ctx.lineTo(x+radius,y),ctx.lineTo(x+radius,y+radius),ctx.lineTo(x,y+radius),ctx.lineTo(x,y),ctx.stroke()},getRotationLong:function(Scores,Qmin,Qmax,Location){var q=Scores*(Math.floor(Math.random()*(Qmax-Qmin))+Qmin);return q+Location}}),Raffle}),define("activity",["./Raffle","./book","jquery"],function(require){var self,$raffle,$activityNum,$prizeIndex,$zhongjiang,$phone,$grade,_result1,_winresult,MATERIAL_URL="http://huodong.api.pptv.com/asia-music/api/pg_material",WINNER_URL="http://huodong.api.pptv.com/asia-music/api/pg_new_winner?num=5",SERACH_BOKING="http://huodong.api.pptv.com/asia-music/api/pg_check_book",SUBMIT_ADDR="http://huodong.api.pptv.com/asia-music/api/pg_winner_message",GET_RESULT="http://huodong.api.pptv.com/asia-music/api/pg_draw",Raffle=require("./Raffle"),Book=require("./book"),$book=new Book,$=require("jquery"),$prize=[],$enableClick=!0,$validateUI=$("#validate"),$validateInputUI=$validateUI.find("input"),$validateSubmitUI=$validateUI.find(".submit"),$validateTipsUI=$validateUI.find(".tips"),$reffleresult1=$("#reffleresult1"),$reffleresult3=$("#reffleresult3"),$reffleresult4=$("#reffleresult4"),$resultBtn1=$reffleresult1.find(".submit"),$reffleresult2=$("#reffleresult2");_result1=$reffleresult1.find(".result").html(),_winresult=$reffleresult2.find(".result").html();var $submitAddrBtn=$reffleresult2.find(".submit"),$addrPhone=$(".input-phone"),$addrName=$(".input-name"),$addr=$(".input-addr"),$scrolltip=$(".scrolltip"),$cjing=$(".cjing"),$mask=$(".rafflemask"),activity=function(){self=this};return activity.prototype={init:function(){$book=new Book,$book.init(),self.load("get",MATERIAL_URL,"jsonp","cb","cb1",function(data){$prize=data,self.create()}),self.load("get",WINNER_URL,"jsonp","cb","cb2",function(data){var newJson=data.concat(data);$.each(newJson,function(idx,obj){$scrolltip.children(".scrolltip-innner").append("<p>恭喜 "+obj.phone+" 获得奖品"+obj.award+"</p>")});var $ps=$scrolltip.children(".scrolltip-innner").children("p"),pCount=$ps.length,$p=$ps.eq(0),pWidth=$p.outerWidth(!0);$scrolltip.children(".scrolltip-innner").width(pWidth*pCount);var marginLeft=0;setInterval(function(){$scrolltip.children(".scrolltip-innner").css({marginLeft:marginLeft}),marginLeft-=1,-marginLeft>pWidth*data.length&&(marginLeft=0)},20)}),$enableClick=$(".rule input").get(0).checked,self.disableClick($enableClick),$(".rule input").on("click",function(){$enableClick=$(".rule input").get(0).checked,self.disableClick($enableClick)}),$resultBtn1.on("click",function(){self.showAlert(!1),$raffle.startUp()}),$validateSubmitUI.on("click",function(){self.checkSubmitMobil($validateInputUI.val(),$validateTipsUI)&&($phone=$validateInputUI.val(),self.getBookingResult())}),$submitAddrBtn.on("click",function(){self.submitAddr()}),$mask.on("click",function(event){self.showAlert(!1)}),$validateUI.find(".gobook").on("click",function(){self.booking()}),$reffleresult3.find(".submit").on("click",function(event){self.booking()}),$reffleresult4.find(".submit").on("click",function(event){self.booking()})},create:function(){var $config={box:"altContent",pointer:"pointer",wmode:"transparent",color:"0|#4E189A|1",prize:$prize,rotationmix:4,rotationmax:7,dis:21,padding:20};$raffle=new Raffle.Slotmachine($config,self.response,self.result),$raffle.startUp()},disableClick:function(enable){enable?$cjing.removeClass("disble"):$cjing.addClass("disble")},booking:function(){self.showAlert(!1),this.mScroll("reverseTabview"),$raffle.startUp()},validateUI:function(phone,tips){$validateInputUI.val(phone),$validateTipsUI.html(tips),self.showAlert(!0),$validateUI.show()},getRaffleResult:function(){self.load("get",GET_RESULT+"?p="+$phone,"jsonp","cb","cb4",function(data){switch(data.err){case 1:$validateUI.is(":hidden")?self.validateUI("",""):self.validateUI($phone,data.msg);break;case 0:case 5:self.showAlert(!1),$activityNum>0&&$activityNum--,$zhongjiang="0"==data.err;var $id=data.data?data.data.type:"1";$grade=data.data?data.data.grade:"",$.each($prize,function(idx,obj){$id==obj.id&&($prizeIndex=idx,$reffleresult2.find("img")[0].src=obj.img)}),$raffle.execute({prizeindex:$prizeIndex});break;case 2:$validateUI.is(":hidden")?self.validateUI("",""):self.validateUI($phone,data.msg)}})},getBookingResult:function(){self.load("get",SERACH_BOKING+"?telphone="+$phone,"jsonp","cb","cb3",function(data){1==data.status?($activityNum=data.count,$activityNum>0?self.getRaffleResult():(self.showAlert(!1),$reffleresult4.show(),self.showAlert(!0))):$validateUI.is(":hidden")?self.validateUI("",""):self.validateUI($phone,data.message)})},submitAddr:function(){if($addrName.val()&&$addrName.val().length>0&&$addrName.val()&&$addrName.val().length>0){var $a=SUBMIT_ADDR+"?phone="+$phone+"&username="+$addrName.val()+"&addr="+$addr.val();self.load("get",$a,"jsonp","cb","cb4",function(data){})}self.showAlert(!1)},showAlert:function(value){$book.loopTap(!value),value?$mask.show():($reffleresult1.hide(),$reffleresult2.hide(),$reffleresult3.hide(),$reffleresult4.hide(),$validateUI.hide(),$mask.hide())},response:function(){$enableClick&&($phone=$book.getTel(),void 0==$phone?self.validateUI("",""):self.getBookingResult())},result:function(data){if($zhongjiang){self.showAlert(!0),$reffleresult2.show();var lphone=$phone.replace($phone.substr(3,4),"****");$reffleresult2.find(".result").html(_winresult.replace("%num%",$grade)),$addrPhone.val(lphone)}else $activityNum>0?($reffleresult1.show(),$reffleresult1.find(".result").html(_result1.replace("%num%",$activityNum))):$reffleresult3.show(),self.showAlert(!0)},load:function(type,url,dataType,jsonp,jsonpCallback,fun){$enableClick&&$.ajax({type:type,url:url,dataType:dataType,cache:!1,jsonp:jsonp,jsonpCallback:jsonpCallback,timeout:3e4,success:function(result){fun.call(this,result)},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("通讯失败或返回数据非"+dataType+"格式")}})},checkSubmitMobil:function(value,tips){if(""==value)return tips&&tips.html("手机号码不能为空！"),!1;var myreg=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return myreg.test(value)?(tips&&tips.html(""),!0):(tips&&tips.html("手机号码格式不正确！"),!1)},mScroll:function(value){$("html,body").stop(!0),$("html,body").animate({scrollTop:$("."+value).offset().top},100)}},activity}),define("book",["jquery"],function(require,exports,module){function TimeTick(gapTime,ao){this.running=!1,this.interval=gapTime,this.actionObejct=ao,this.onTimer=null,this.lastTime=0,this._timer=0}function Reserve(){self=this,this.config,this.selectTab=0,this.selectData,this.deadlinetime=-1,this._timer,this.serviceTime=0,this.booked=!1,this.tel="",this.selectTimer=0,this.isShowDialog=!1,this.isRequest=!1,this.isapp=!1}var $=require("jquery"),TIME_URL="http://time.pptv.com",reserveSrc="http://huodong.api.pptv.com/asia-music/api/pg_book?";TimeTick.prototype={start:function(){var that=this;this.running||(this.running=!0,this.lastTime=(new Date).getTime(),this._timer=setInterval(function(){that.onTick()},this.interval))},stop:function(){var that=this;window.clearInterval(that._timer),this.running&&(this._timer=0,this.running=!1)},onTick:function(){var espTime=(new Date).getTime()-this.lastTime;this.lastTime=(new Date).getTime(),null!=this.onTimer&&this.onTimer(espTime,this.actionObejct)}};var self;Reserve.prototype={init:function(){this.config=config||{},$.isEmptyObject(this.config)&&console.log("config is null");var app=(window.location.href+"?random="+Math.random(),self.getQueryString("plt"));app&&"app"==app&&(this.isapp=!0),$(".maskall").click(function(e){self.isShowDialog&&e.target==this&&(self.showDialog(!1),self.showShare(!1))}),$(".btn").each(function(n){var node=$(this);node.hasClass("share")?self.booked=!0:self.booked=!1,node.click(function(e){e.stopImmediatePropagation(),$(this).hasClass("book")&&($(this).hasClass("share")?self.showShare(!0):$(this).hasClass("success")||self.showDialog(!0))})}),$($(".tabs").children()).each(function(n){var node=$(this);node.click({ele:node,index:n},self.onTab)}),$(".tabcon").each(function(n){var node=$(this),ele=node.find(".playicon");ele.attr("href")}),$("#bookOk").click(self.onOK),$("#bookCancel").click(self.onCanceled),$("#book input").focus(self.onFocused),$(".sharebox a").click(function(e){e.stopImmediatePropagation(),self.showShare(!1)}),this.getSelectedTab(),this.selected(this.selectTab),this.timeTick=new TimeTick(7e3,this),this.timeTick.onTimer=function(espTime,actionObejct){var i=actionObejct.selectTab+1;actionObejct.selected(i%4)},this.loopTap(!0)},getSelectedTab:function(){$($(".tabs").children()).each(function(n){var node=$(this);return node.hasClass("now")?void(self.selectTab=n):void 0})},onTab:function(e){e.stopImmediatePropagation();var data=e.data,index=data.index;data.ele;self.selected(index)},selected:function(index){self.selectTab=index,self.loadServerTime(TIME_URL,"cb",self.onTimer),self.booked=!1,$($(".tabs").children()).each(function(n){var node=$(this);if(n==index){if(node.hasClass("now"))return;node.addClass("now")}else node.hasClass("now")&&node.removeClass("now")}),$(".tabcon").each(function(n){var node=$(this);if(n==index)node.hasClass("hidden")&&node.removeClass("hidden");else{if(node.hasClass("hidden"))return;node.addClass("hidden")}}),$(".btn").each(function(n){$(this);$(this).hasClass("share")&&(self.booked=!0)})},load:function(src,cb,callback){self.isRequest=!0,$.ajax({type:"get",url:src,jsonp:cb,dataType:"jsonp",jsonpCallback:"book",success:function(data){"function"==typeof callback&&callback.call(this,data)},complete:function(XMLHttpRequest,status){self.isRequest=!1,("timeout"==status||"error"==status)&&console.log("出错啦!error="+status)}})},loadServerTime:function(src,cb,callback){$.ajax({type:"get",url:src,cache:!0,jsonp:"cb",jsonpCallback:"p",dataType:"jsonp",success:function(data){"function"==typeof callback&&callback.call(this,data)},error:function(msg){console.log("error,"+msg)}})},onTimer:function(data){self.serviceTime=Math.floor(data),self.setDeadlineTime()},setDeadlineTime:function(){var node=(new Date(1e3*self.serviceTime),$(".tabcon")[self.selectTab]),arr=self.config[self.selectTab].count_down_time,arrEnd=self.config[self.selectTab].live_end_time;if(arr&&arrEnd){var dd=$(node).find("dd"),timeEleArr=dd.children("span"),timeArr=[],endtimeArr=[];if(8==timeEleArr.length){for(var i in arr){if(timeArr[i]=self.toDate(arr[i]),endtimeArr[i]=self.toDate(arrEnd[i]),timeArr[i].getTime()/1e3>self.serviceTime){self.deadlinetime=timeArr[i].getTime()/1e3-self.serviceTime;break}if(timeArr[i].getTime()/1e3<self.serviceTime&&endtimeArr[i].getTime()/1e3>self.serviceTime){self.deadlinetime=0;break}i==arr.length-1&&(self.deadlinetime=0)}self.deadlinetime>=0&&(self._timer||(self._timer=setInterval(function(){self.timer()},1e3)))}}},timer:function(deadlinetime){if(self.deadlinetime<0)return void(self._timer&&(clearInterval(self._timer),self._timer=0));var node=$(".tabcon")[self.selectTab],dd=$(node).find("dd"),timeEleArr=dd.children("span"),d=(new Date(self.deadlinetime),Math.floor(self.deadlinetime/86400)),h=Math.floor((self.deadlinetime-24*d*3600)/3600),m=Math.floor((self.deadlinetime-24*d*3600-3600*h)/60),s=self.deadlinetime-24*d*3600-3600*h-60*m;10>d?($(timeEleArr[0]).text("0"),$(timeEleArr[1]).text(d)):($(timeEleArr[0]).text(self.getNumberByBit(d,1)),$(timeEleArr[1]).text(self.getNumberByBit(d,0))),10>h?($(timeEleArr[2]).text("0"),$(timeEleArr[3]).text(h)):($(timeEleArr[2]).text(self.getNumberByBit(h,1)),$(timeEleArr[3]).text(self.getNumberByBit(h,0))),10>m?($(timeEleArr[4]).text("0"),$(timeEleArr[5]).text(m)):($(timeEleArr[4]).text(self.getNumberByBit(m,1)),$(timeEleArr[5]).text(self.getNumberByBit(m,0))),10>s?($(timeEleArr[6]).text("0"),$(timeEleArr[7]).text(s)):($(timeEleArr[6]).text(self.getNumberByBit(s,1)),$(timeEleArr[7]).text(self.getNumberByBit(s,0))),self.deadlinetime--},showDialog:function(bl){self.isShowDialog=bl,bl?($("#book").show(),$("#book input").focus(),self.showMask(!0),self.loopTap(!1),$("#book span").text("")):($("#book").hide(),self.showMask(!1),self.loopTap(!0))},loopTap:function(bl){bl?self.timeTick.start():self.timeTick.stop()},showShare:function(bl){if(self.isShowDialog=bl,bl){var uurl=window.location.href+"?random="+Math.random();uurl=uurl.replace("plt=app","");var title="我预定了亚洲音乐节"+self.config[self.selectTab].title+"，更多精彩，尽在聚力视频",imgPath="http://sr1.pplive.com/cms/42/28/4c1751fba288064eae11fd0e2c17d651.png",weibo="http://v.t.sina.com.cn/share/share.php?c=spr_web_bd_pplive_weibo&url="+encodeURIComponent(uurl)+"&title="+encodeURIComponent(title)+"&source=聚力视频&sourceUrl="+encodeURIComponent("http://www.pptv.com")+"&content=utf-8&pic="+encodeURIComponent(imgPath)+"&appkey=1938876518",qzone="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(uurl)+"&title="+encodeURIComponent(title)+"&pics="+encodeURIComponent(imgPath),qq="http://connect.qq.com/widget/shareqq/index.html?title="+encodeURIComponent(title)+"&url="+encodeURIComponent(uurl)+"&desc="+encodeURIComponent(title)+"&pics="+encodeURIComponent(imgPath)+"&site="+encodeURIComponent("http://www.pptv.com");self.isapp?window.ppsdkReady&&!window.isIOS?ppsdk.share({shareText:title,shareURL:uurl,shareImageURL:imgPath,success:function(data){console.log("ppsdk success")},error:function(code,data){console.log("ppsdk error="+code+","+data)},cancel:function(){console.log("ppsdk cancel")}}):alert("请稍后分享,jjsdk文件未加载完"):($(".sharebox").show(),self.showMask(!0),$(".sharebox a").attr("href","javascript:;"),$(".s1").parent().attr("href",weibo),$(".s2").parent().attr("href",qzone),$(".s3").parent().attr("href",qq)),self.loopTap(!1)}else $(".sharebox").hide(),self.showMask(!1),self.loopTap(!0)},showMask:function(bl){bl?$(".maskall").show():$(".maskall").hide()},onReserve:function(data){try{var msg=data.message||"预定失败",status=data.status+"";switch(status){case"1":self.reserveSuccess(!0,status);break;case"0":self.reserveSuccess(!0,status),$("#book span").text("该专场已经预定");break;case"-1":case"-2":case"-3":$("#book span").text(msg);break;default:$("#book span").text(msg)}}catch(e){console.log("error",e)}},reserveSuccess:function(bl,status){var node=$(".tabcon")[self.selectTab];if(self.booked=!0,self.saveTel(self.tel),"1"==status){self.showDialog(!1);var num=parseInt(self.config[self.selectTab].book_number)+1;$(node).find("p").text("已经有"+num+"人预约")}window.isIOS&&self.isapp?($(node).find(".btn").addClass("success"),$(node).find(".btn").html("预定成功")):($(node).find(".btn").addClass("share"),$(node).find(".btn").html("<i></i>与小伙伴分享吧"))},onOK:function(e){if(e.stopImmediatePropagation(),self.isRequest)return void $("#book span").text("正在预定中,请稍等");var tips="",tx=$("#book input").val();if(""==tx?tips="手机号码不能为空":/[^\d]/g.test(tx)?tips="请输入有效的手机号码":self.isMobile(tx)||(tips="请输入有效的手机号码"),""!=tips)$("#book span").text(tips);else{self.tel=tx;var id=self.config[self.selectTab].id;self.load(reserveSrc+"telphone="+tx+"&special="+id,"cb",self.onReserve)}},onCanceled:function(e){e.stopImmediatePropagation(),self.showDialog(!1)},onFocused:function(e){$("#book input").attr("value").indexOf("手机号码")>-1&&$("#book input").attr("value","")},isMobile:function(value){var length=value.length,mobile=/^(13[0-9]{9})|(18[0-9]{9})|(14[0-9]{9})|(17[0-9]{9})|(15[0-9]{9})$/;return 11==length&&mobile.test(value)},toDate:function(value){var str=value;str=str.replace(/-/g,"/");var date=new Date(str);return date},getNumberByBit:function(num,b){if("number"==typeof num){var str=num+"";return str.length>b?str.charAt(str.length-b-1):""}return""},copyToClipboard:function(text){var textArea=document.createElement("textarea");textArea.style.position="fixed",textArea.style.top=0,textArea.style.left=0,textArea.style.width="2em",textArea.style.height="2em",textArea.style.padding=0,textArea.style.border="none",textArea.style.outline="none",textArea.style.boxShadow="none",textArea.style.background="transparent",textArea.value=text,document.body.appendChild(textArea),textArea.select();try{var successful=document.execCommand("copy")}catch(err){console.log("Oops, unable to copy")}return document.body.removeChild(textArea),successful},saveTel:function(tel){if(""!=tel&&window.localStorage){var type="booke_tel";localStorage[type]=tel}},getTel:function(){var type="booke_tel",tel=localStorage[type];return tel},getQueryString:function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(reg);return null!=r?unescape(r[2]):null}},module.exports=Reserve}),define("index",["jquery","./book","./activity","./Raffle"],function(require){function MusicActPre(){this.act=new activity,this.act.init()}var $=require("jquery"),isLoadSdk=!1;window.ppsdkReady=!1,$(document).ready(function(){ppsdk.config({}),isLoadSdk=!0,ppsdk.ready(function(){window.ppsdkReady=!0}),ppsdk.error(function(code,msg){window.ppsdkReady=!1});var determineOS=function(){var ua=navigator.userAgent.toLowerCase();return ua.indexOf("ipad")>0&&ua.indexOf("linux")<0?1:ua.indexOf("iphone")>0&&ua.indexOf("linux")<0?2:ua.indexOf("android")>0&&ua.indexOf("linux")>0?3:ua.indexOf("windows phone")>0?4:ua.indexOf("windows")>0?5:ua.indexOf("mac")>0&&ua.indexOf("linux")<0?6:7};window.isIOS=2==determineOS()?!0:!1});require("./book");activity=require("./activity"),MusicActPre.prototype={init:function(){}};new MusicActPre});